import { Exploit, VersionPropertyStore } from "../exploit";

export class HiMDUnboundedReading extends Exploit{
    static _name = "HiMDUnboundedReading";
    public _policies = {
        permanent: true,
    };

    protected getPropertyStore(): VersionPropertyStore {
        return {
            address: {
                "Hr1.000": 0x000995e8,

                "Hn1.000": 0x0009e558,
                "Hn1.100": 0x0009dfd4,
                "Hn1.10A": 0x0009e05c,
                "Hn1.200": 0x0009dcd0,
            },
            data: {
                "Hr*,Hn*": new Uint8Array([0x00, 0x20, 0x70, 0x47]),
            },
        };
    }
    
    public override async init(){
        if(!this.stateManager.device.isHimd) return;
        await this.stateManager.patch(this.getProperty("address"), this.getProperty("data"));
    }
}
