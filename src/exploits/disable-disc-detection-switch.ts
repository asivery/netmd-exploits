import { Exploit, ExploitPolicies, VersionPropertyStore } from "../exploit";

export class DisableDiscDetection extends Exploit{
    static readonly _name = "DisableDiscDetection";
    public _policies: ExploitPolicies = {
        stateManagerUnpatchLegal: true,
    };

    protected getPropertyStore(): VersionPropertyStore {
        return {
            address: {
                'S1.000': 0x0003dc7c,
                'S1.600': 0x0003db8c,
                'S1.500': 0x0003d69c,
                'S1.400': 0x0003d194,
                'S1.300': 0x0003ac1c,
                'S1.200': 0x0003a1f4,
                'S1.100': 0x00039c9c,
            },
            value: {
                'S*': new Uint8Array([0x70, 0x47, 0x70, 0x47]),
            },
        };
    }

    async init() {
        await this.stateManager.patch(this.getProperty("address"), this.getProperty("value"));
    }
}